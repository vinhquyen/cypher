/**
 * @copyright Â©Melqui Brito. All rights reserved.
 * @author Melqui Brito
 * @version 1.0.0 (2020-04-08)
 * @descreption Clean, fast and efficient methods appended to String.prototype and Object.prototype for encryption and decryption based on synchronous cryptography. 
 * Encryption and decryption are done by the use of symmetric keys.
 */

!function(){String.prototype.encrypt=function(t){let e=t?t.toString():void 0;if(e&&e.length&&this.length){let t=encodeURIComponent(e).split(""),n=encodeURIComponent(this).split(""),r=function(t){let e=t<0?127+t:t>93?t-93+32:33+t;return String.fromCharCode(e)},a={key:Math.floor(Math.random()*t.length),data:Math.floor(Math.random()*n.length)},o=a.key,c=a.data,i=!1,d=!1,l=function(){o===t.length&&(o=0),o===a.key&&(i=!0),c===n.length&&(c=0),c===a.data&&(d=!0)};for(;!i||!d;)n[c]=r(t[o].charCodeAt(0)-n[c].charCodeAt(0)),o++,c++,l();let h={key:0===o?t.length-1:o-1,data:0===c?n.length-1:c-1},y=n.length>93?93:n.length-1,p={key:Math.round(Math.random()*y),data:Math.round(Math.random()*y)},s={key:String.fromCharCode(127-h.key.toString().length),data:String.fromCharCode(127-h.data.toString().length)},u={key:String.fromCharCode(126-p.key),data:String.fromCharCode(126-p.data)},x=n.join("");return x=(x=x.slice(0,p.key)+s.key+h.key+x.slice(p.key)).slice(0,p.data)+s.data+h.data+x.slice(p.data),u.key+x+u.data}return null},String.prototype.decrypt=function(t){let e=t?t.toString():void 0;if(e&&e.length&&this.length){let t=[],n=encodeURIComponent(e).split(""),r={key:126-this.charCodeAt(0),data:126-this.charCodeAt(this.length-1)},a=this.slice(1,this.length-1),o={key:void 0,data:parseInt(a.slice(r.data+1,r.data+(128-a[r.data].charCodeAt(0))))};a=a.slice(0,r.data)+a.slice(r.data+(128-a[r.data].charCodeAt(0))),o.key=parseInt(a.slice(r.key+1,r.key+1+(127-a[r.key].charCodeAt(0)))),a=a.slice(0,r.key)+a.slice(r.key+(128-a[r.key].charCodeAt(0))),t=a.split("");let c=o.key,i=o.data,d=!1,l=!1,h=function(){-1===c&&(c=n.length-1),-1===i&&(i=t.length-1),c===o.key&&(d=!0),i===o.data&&(l=!0)};for(;!d||!l;){let e=n[c].charCodeAt(0)-(t[i].charCodeAt(0)-33);e<33&&(e=n[c].charCodeAt(0)-(t[i].charCodeAt(0)-127)),t[i]=String.fromCharCode(e),c--,i--,h()}try{return decodeURIComponent(t.join(""))}catch(e){return t.join("")}}return null},this.getSymmetricKey=function(){let t=(new Date).getTime(),e=performance&&performance.now&&1e3*performance.now()||-1;return t=t.toString(),e=e.toString().slice(0,4),"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyyyyyyzz".replace(/[xyz]/g,function(n){let r;return"x"===n?r=Math.round(93*Math.random()):("y"===n&&(r=parseInt(t.slice(0,2)),t=t.slice(2)),"z"===n&&(e>0?(r=parseInt(e.slice(0,2)),e=e.slice(2)):r=Math.round(93*Math.random()))),34!==r&&39!==r&&92!==r||r++,function(t){let e=t>93?t-93+32:33+t;return String.fromCharCode(e)}(r)})},Object.prototype.encrypt=function(t){let e=JSON.stringify(this).encrypt(t);return e?{"encrypted-data":e}:null},Object.prototype.decrypt=function(t){if(this.hasOwnProperty("encrypted-data")&&"string"==typeof this["encrypted-data"])try{return JSON.parse(this["encrypted-data"].decrypt(t))}catch(t){return null}return null},Object.encrypt=function(t,e,n=!0){try{let r=t.encrypt(e);return r="object"!=typeof r||n?r:r["encrypted-data"]}catch(t){return null}},Object.decrypt=function(t,e,n=!0){let r=typeof t,a=t.decrypt(e);try{return n?a="object"===r?a:JSON.parse(a):"number"!==r&&"object"!==r||(a=JSON.stringify(a)),a}catch(t){return null}}}();
