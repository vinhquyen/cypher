/**
 * @copyright Â©Melqui Brito. All rights reserved.
 * @author Melqui Brito
 * @version 1.0.0 (2020-04-08)
 * @descreption Clean, fast and efficient methods appended to String.prototype and Object.prototype for encryption and decryption based on synchronous cryptography. 
 * Encryption and decryption are done by the use of symmetric keys.
 */

String.prototype.encrypt=function(t){let e=t?t.toString():void 0;if(e&&e.length&&this.length){let t=encodeURIComponent(e).split(""),n=encodeURIComponent(this).split(""),r=function(t){let e=t<0?127+t:t>93?t-93+32:33+t;return String.fromCharCode(e)},o=0,c=0,l=!1,i=!1,h=t.length>n.length;for(;!l||!i;)n[c]=r(t[o].charCodeAt(0)-n[c].charCodeAt(0)),c++,++o===t.length&&(o=0,l=!0),c===n.length&&(c=0,i=!0);let a=h?c-1:o-1,p=n.length>93?93:n.length-1,d=Math.round(Math.random()*p);a<0&&(a=h?n.length:t.length,a--);let x=String.fromCharCode(a+33),y=String.fromCharCode(126-d),g=n.join("");return y+(g=g.slice(0,d)+x+g.slice(d))}return null},String.prototype.decrypt=function(t){let e=t?t.toString():void 0;if(e&&e.length&&this.length){let t=[],n=encodeURIComponent(e).split(""),r=126-this.charCodeAt(0),o=this.slice(1),c=o[r].charCodeAt(0)-33;o=o.slice(0,r)+o.slice(r+1),t=o.split("");let l=n.length-1,i=t.length-1,h=n.length>t.length,a=h?n.length:t.length;h?i=c:l=c;let p=function(){l<0&&(l=n.length-1),-1===i&&(i=t.length-1)},d=function(){i<0&&(i=t.length-1),-1===l&&(l=n.length-1)},x=h?p:d;for(let e=0;e<a;e++){let e=n[l].charCodeAt(0)-(t[i].charCodeAt(0)-33);e<33&&(e=n[l].charCodeAt(0)-(t[i].charCodeAt(0)-127)),t[i]=String.fromCharCode(e),l--,i--,x()}try{return decodeURIComponent(t.join(""))}catch(e){return t.join("")}}return null},String.getSymmetricKey=function(){let t=(new Date).getTime(),e=performance&&performance.now&&1e3*performance.now()||-1;return t=t.toString(),e=e.toString().slice(0,4),"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyyyyyyzz".replace(/[xyz]/g,function(n){let r;return"x"===n?r=Math.round(93*Math.random()):("y"===n&&(r=parseInt(t.slice(0,2)),t=t.slice(2)),"z"===n&&(e>0?(r=parseInt(e.slice(0,2)),e=e.slice(2)):r=Math.round(93*Math.random()))),34!==r&&39!==r&&92!==r||r++,function(t){let e=t>93?t-93+32:33+t;return String.fromCharCode(e)}(r)})},Object.prototype.encrypt=function(t){let e=JSON.stringify(this).encrypt(t);return e?{"encrypted-data":e}:null},Object.prototype.decrypt=function(t){if(this.hasOwnProperty("encrypted-data")&&"string"==typeof this["encrypted-data"])try{return JSON.parse(this["encrypted-data"].decrypt(t))}catch(t){return null}return null},Object.encrypt=function(t,e,n=!0){try{let r=t.encrypt(e);return r="object"!=typeof r||n?r:r["encrypted-data"]}catch(t){return}},Object.decrypt=function(t,e,n=!0){let r=typeof t;try{let o;return n?o="object"===r?t.decrypt(e):JSON.parse(t.decrypt(e)):(o=t.decrypt(e),"number"!==r&&"object"!==r||(o=JSON.stringify(o))),o}catch(t){return}};
